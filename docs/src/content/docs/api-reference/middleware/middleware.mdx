---
title: Middleware
description: Middleware system for LogicPwn
category: Middleware
sidebar:
  order: 84
---

import { Code, Aside, Steps, Tabs, TabItem } from '@astrojs/starlight/components';

**Category:** Middleware
**Navigation:** [API Reference](../) › [Middleware](../middleware)

Middleware system for LogicPwn.

This module provides a flexible middleware system that allows for
request/response processing hooks. It enables extensibility and custom
processing logic for authentication, logging, retry logic, and other
business logic exploitation workflows.

## Import

```python
import logicpwn.core.middleware.middleware
# or
from logicpwn.core.middleware.middleware import *
```


## Quick Examples

### Basic Usage

```python
from logicpwn.core.exploit_engine import load_exploit_chain_from_file, run_exploit_chain
import requests

# Load and execute a simple exploit chain
session = requests.Session()
chain = load_exploit_chain_from_file("examples/simple_exploit_corrected.yaml")
results = run_exploit_chain(session, chain)

# Analyze results
for result in results:
    print(f"Step: {result.step_name}")
    print(f"Status: {result.status}")
    print(f"Time: {result.execution_time:.2f}s")
```

### Real-World IDOR Testing

```python
from logicpwn.core.access import detect_idor_flaws
from logicpwn.core.auth import AuthConfig, authenticate_session

# Setup authentication
auth_config = AuthConfig(
    url="https://api.example.com/login",
    credentials={"username": "user", "password": "pass"},
    success_indicators=["access_token"]
)

session = authenticate_session(auth_config)

# Test for IDOR vulnerabilities
results = detect_idor_flaws(
    session,
    "https://api.example.com/users/{id}/profile",
    test_ids=["1", "2", "3", "admin", "999"],
    success_indicators=["user_data", "profile"],
    failure_indicators=["unauthorized", "403"]
)
```



## Quick Examples

### Basic Usage

```python
from logicpwn.core.exploit_engine import load_exploit_chain_from_file, run_exploit_chain
import requests

# Load and execute a simple exploit chain
session = requests.Session()
chain = load_exploit_chain_from_file("examples/simple_exploit_corrected.yaml")
results = run_exploit_chain(session, chain)

# Analyze results
for result in results:
    print(f"Step: {result.step_name}")
    print(f"Status: {result.status}")
    print(f"Time: {result.execution_time:.2f}s")
```

### Real-World IDOR Testing

```python
from logicpwn.core.access import detect_idor_flaws
from logicpwn.core.auth import AuthConfig, authenticate_session

# Setup authentication
auth_config = AuthConfig(
    url="https://api.example.com/login",
    credentials={"username": "user", "password": "pass"},
    success_indicators=["access_token"]
)

session = authenticate_session(auth_config)

# Test for IDOR vulnerabilities
results = detect_idor_flaws(
    session,
    "https://api.example.com/users/{id}/profile",
    test_ids=["1", "2", "3", "admin", "999"],
    success_indicators=["user_data", "profile"],
    failure_indicators=["unauthorized", "403"]
)
```



## Quick Examples

### Basic Usage

```python
from logicpwn.core.exploit_engine import load_exploit_chain_from_file, run_exploit_chain
import requests

# Load and execute a simple exploit chain
session = requests.Session()
chain = load_exploit_chain_from_file("examples/simple_exploit_corrected.yaml")
results = run_exploit_chain(session, chain)

# Analyze results
for result in results:
    print(f"Step: {result.step_name}")
    print(f"Status: {result.status}")
    print(f"Time: {result.execution_time:.2f}s")
```

### Real-World IDOR Testing

```python
from logicpwn.core.access import detect_idor_flaws
from logicpwn.core.auth import AuthConfig, authenticate_session

# Setup authentication
auth_config = AuthConfig(
    url="https://api.example.com/login",
    credentials={"username": "user", "password": "pass"},
    success_indicators=["access_token"]
)

session = authenticate_session(auth_config)

# Test for IDOR vulnerabilities
results = detect_idor_flaws(
    session,
    "https://api.example.com/users/{id}/profile",
    test_ids=["1", "2", "3", "admin", "999"],
    success_indicators=["user_data", "profile"],
    failure_indicators=["unauthorized", "403"]
)
```



## Quick Examples

### Basic Usage

```python
from logicpwn.core.exploit_engine import load_exploit_chain_from_file, run_exploit_chain
import requests

# Load and execute a simple exploit chain
session = requests.Session()
chain = load_exploit_chain_from_file("examples/simple_exploit_corrected.yaml")
results = run_exploit_chain(session, chain)

# Analyze results
for result in results:
    print(f"Step: {result.step_name}")
    print(f"Status: {result.status}")
    print(f"Time: {result.execution_time:.2f}s")
```

### Real-World IDOR Testing

```python
from logicpwn.core.access import detect_idor_flaws
from logicpwn.core.auth import AuthConfig, authenticate_session

# Setup authentication
auth_config = AuthConfig(
    url="https://api.example.com/login",
    credentials={"username": "user", "password": "pass"},
    success_indicators=["access_token"]
)

session = authenticate_session(auth_config)

# Test for IDOR vulnerabilities
results = detect_idor_flaws(
    session,
    "https://api.example.com/users/{id}/profile",
    test_ids=["1", "2", "3", "admin", "999"],
    success_indicators=["user_data", "profile"],
    failure_indicators=["unauthorized", "403"]
)
```



## Quick Examples

### Basic Usage

```python
from logicpwn.core.exploit_engine import load_exploit_chain_from_file, run_exploit_chain
import requests

# Load and execute a simple exploit chain
session = requests.Session()
chain = load_exploit_chain_from_file("examples/simple_exploit_corrected.yaml")
results = run_exploit_chain(session, chain)

# Analyze results
for result in results:
    print(f"Step: {result.step_name}")
    print(f"Status: {result.status}")
    print(f"Time: {result.execution_time:.2f}s")
```

### Real-World IDOR Testing

```python
from logicpwn.core.access import detect_idor_flaws
from logicpwn.core.auth import AuthConfig, authenticate_session

# Setup authentication
auth_config = AuthConfig(
    url="https://api.example.com/login",
    credentials={"username": "user", "password": "pass"},
    success_indicators=["access_token"]
)

session = authenticate_session(auth_config)

# Test for IDOR vulnerabilities
results = detect_idor_flaws(
    session,
    "https://api.example.com/users/{id}/profile",
    test_ids=["1", "2", "3", "admin", "999"],
    success_indicators=["user_data", "profile"],
    failure_indicators=["unauthorized", "403"]
)
```


## Classes

:::note[Available Classes]
This module provides 9 class(es) for middleware.
:::

### AuthenticationMiddleware

<Tabs>
<TabItem label="Overview">

```python
class AuthenticationMiddleware (BaseMiddleware):
    """
    Middleware for handling authentication
    """
```

Middleware for handling authentication.

</TabItem>
<TabItem label="Constructor">

```python
def __init__(self, auth_manager=None)
```

Initialize a new instance of `AuthenticationMiddleware`.

</TabItem>
</Tabs>

#### Methods

##### disable

:::note[Method]
Instance method
:::

```python
def disable(self)
```

Disable the middleware.

##### enable

:::note[Method]
Instance method
:::

```python
def enable(self)
```

Enable the middleware.

##### process_request

:::note[Method]
Instance method
:::

```python
def process_request(self, context: logicpwn.core.middleware.middleware.MiddlewareContext) -> logicpwn.core.middleware.middleware.MiddlewareContext
```

Add authentication headers to request.

##### process_response

:::note[Method]
Instance method
:::

```python
def process_response(self, context: logicpwn.core.middleware.middleware.MiddlewareContext, response: Any) -> Any
```

Process authentication-related response data.


---

### BaseMiddleware

<Tabs>
<TabItem label="Overview">

```python
class BaseMiddleware (ABC):
    """
    Base class for all middleware
    """
```

Base class for all middleware.

</TabItem>
<TabItem label="Constructor">

```python
def __init__(self, name: str)
```

Initialize a new instance of `BaseMiddleware`.

</TabItem>
</Tabs>

#### Methods

##### disable

:::note[Method]
Instance method
:::

```python
def disable(self)
```

Disable the middleware.

##### enable

:::note[Method]
Instance method
:::

```python
def enable(self)
```

Enable the middleware.

##### process_request

:::note[Method]
Instance method
:::

```python
def process_request(self, context: logicpwn.core.middleware.middleware.MiddlewareContext) -> logicpwn.core.middleware.middleware.MiddlewareContext
```

Process request before it's sent.

##### process_response

:::note[Method]
Instance method
:::

```python
def process_response(self, context: logicpwn.core.middleware.middleware.MiddlewareContext, response: Any) -> Any
```

Process response after it's received.


---

### LoggingMiddleware

<Tabs>
<TabItem label="Overview">

```python
class LoggingMiddleware (BaseMiddleware):
    """
    Middleware for request/response logging
    """
```

Middleware for request/response logging.

</TabItem>
<TabItem label="Constructor">

```python
def __init__(self)
```

Initialize a new instance of `LoggingMiddleware`.

</TabItem>
</Tabs>

#### Methods

##### disable

:::note[Method]
Instance method
:::

```python
def disable(self)
```

Disable the middleware.

##### enable

:::note[Method]
Instance method
:::

```python
def enable(self)
```

Enable the middleware.

##### process_request

:::note[Method]
Instance method
:::

```python
def process_request(self, context: logicpwn.core.middleware.middleware.MiddlewareContext) -> logicpwn.core.middleware.middleware.MiddlewareContext
```

Log request details.

##### process_response

:::note[Method]
Instance method
:::

```python
def process_response(self, context: logicpwn.core.middleware.middleware.MiddlewareContext, response: Any) -> Any
```

Log response details.


---

### MiddlewareContext

<Tabs>
<TabItem label="Overview">

```python
class MiddlewareContext:
    """
    Context passed to middleware hooks
    """
```

Context passed to middleware hooks.

</TabItem>
<TabItem label="Constructor">

```python
def __init__(self, request_id: str, url: str, method: str, headers: dict[str, str], params: Optional[dict[str, Any]] = None, body: Optional[Any] = None, timeout: Optional[int] = None, session_data: Optional[dict[str, Any]] = None, metadata: Optional[dict[str, Any]] = None) -> None
```

Initialize a new instance of `MiddlewareContext`.

</TabItem>
</Tabs>


---

### MiddlewareManager

<Tabs>
<TabItem label="Overview">

```python
class MiddlewareManager:
    """
    Manages middleware execution order and lifecycle
    """
```

Manages middleware execution order and lifecycle.

</TabItem>
<TabItem label="Constructor">

```python
def __init__(self)
```

Initialize a new instance of `MiddlewareManager`.

</TabItem>
</Tabs>

#### Methods

##### add_middleware

:::note[Method]
Instance method
:::

```python
def add_middleware(self, middleware: logicpwn.core.middleware.middleware.BaseMiddleware)
```

Add middleware to the chain.

##### disable_middleware

:::note[Method]
Instance method
:::

```python
def disable_middleware(self, name: str)
```

Disable middleware by name.

##### enable_middleware

:::note[Method]
Instance method
:::

```python
def enable_middleware(self, name: str)
```

Enable middleware by name.

##### get_middleware

:::note[Method]
Instance method
:::

```python
def get_middleware(self, name: str) -> Optional[logicpwn.core.middleware.middleware.BaseMiddleware]
```

Get middleware by name.

##### list_middleware

:::note[Method]
Instance method
:::

```python
def list_middleware(self) -> list[dict[str, typing.Any]]
```

List all middleware with their status.

##### process_request

:::note[Method]
Instance method
:::

```python
def process_request(self, context: logicpwn.core.middleware.middleware.MiddlewareContext) -> logicpwn.core.middleware.middleware.MiddlewareContext
```

Process request through all enabled middleware.

##### process_response

:::note[Method]
Instance method
:::

```python
def process_response(self, context: logicpwn.core.middleware.middleware.MiddlewareContext, response: Any) -> Any
```

Process response through all enabled middleware (in reverse order).

##### remove_middleware

:::note[Method]
Instance method
:::

```python
def remove_middleware(self, name: str)
```

Remove middleware by name.


---

### RetryException

<Tabs>
<TabItem label="Overview">

```python
class RetryException (Exception):
    """
    Exception raised when a request should be retried
    """
```

Exception raised when a request should be retried.

</TabItem>
<TabItem label="Constructor">

```python
def __init__(self, message, original_exception=None, retries=None)
```

Initialize a new instance of `RetryException`.

</TabItem>
</Tabs>

#### Properties

<details>
<summary><code>retry_count</code></summary>

Property `retry_count` of type `Any`.

</details>


---

### RetryMiddleware

<Tabs>
<TabItem label="Overview">

```python
class RetryMiddleware (BaseMiddleware):
    """
    Middleware for handling retries and backoff
    """
```

Middleware for handling retries and backoff.

</TabItem>
<TabItem label="Constructor">

```python
def __init__(self, max_retries: Optional[int] = None, backoff_factor: float = 2.0)
```

Initialize a new instance of `RetryMiddleware`.

</TabItem>
</Tabs>

#### Methods

##### disable

:::note[Method]
Instance method
:::

```python
def disable(self)
```

Disable the middleware.

##### enable

:::note[Method]
Instance method
:::

```python
def enable(self)
```

Enable the middleware.

##### process_request

:::note[Method]
Instance method
:::

```python
def process_request(self, context: logicpwn.core.middleware.middleware.MiddlewareContext) -> logicpwn.core.middleware.middleware.MiddlewareContext
```

Add retry information to context.

##### process_response

:::note[Method]
Instance method
:::

```python
def process_response(self, context: logicpwn.core.middleware.middleware.MiddlewareContext, response: Any) -> Any
```

Handle retry logic based on response.


---

### SecurityMiddleware

<Tabs>
<TabItem label="Overview">

```python
class SecurityMiddleware (BaseMiddleware):
    """
    Middleware for security analysis and validation
    """
```

Middleware for security analysis and validation.

</TabItem>
<TabItem label="Constructor">

```python
def __init__(self)
```

Initialize a new instance of `SecurityMiddleware`.

</TabItem>
</Tabs>

#### Methods

##### disable

:::note[Method]
Instance method
:::

```python
def disable(self)
```

Disable the middleware.

##### enable

:::note[Method]
Instance method
:::

```python
def enable(self)
```

Enable the middleware.

##### process_request

:::note[Method]
Instance method
:::

```python
def process_request(self, context: logicpwn.core.middleware.middleware.MiddlewareContext) -> logicpwn.core.middleware.middleware.MiddlewareContext
```

Validate request for security issues.

##### process_response

:::note[Method]
Instance method
:::

```python
def process_response(self, context: logicpwn.core.middleware.middleware.MiddlewareContext, response: Any) -> Any
```

Analyze response for security issues.


---

### SessionMiddleware

<Tabs>
<TabItem label="Overview">

```python
class SessionMiddleware (BaseMiddleware):
    """
    Middleware for session management
    """
```

Middleware for session management.

</TabItem>
<TabItem label="Constructor">

```python
def __init__(self)
```

Initialize a new instance of `SessionMiddleware`.

</TabItem>
</Tabs>

#### Methods

##### disable

:::note[Method]
Instance method
:::

```python
def disable(self)
```

Disable the middleware.

##### enable

:::note[Method]
Instance method
:::

```python
def enable(self)
```

Enable the middleware.

##### process_request

:::note[Method]
Instance method
:::

```python
def process_request(self, context: logicpwn.core.middleware.middleware.MiddlewareContext) -> logicpwn.core.middleware.middleware.MiddlewareContext
```

Add session data to request.

##### process_response

:::note[Method]
Instance method
:::

```python
def process_response(self, context: logicpwn.core.middleware.middleware.MiddlewareContext, response: Any) -> Any
```

Extract session data from response.


---

## Functions

:::note[Available Functions]
This module provides 6 function(s) for direct use.
:::

### add_middleware

:::note[Function]
Module function
:::

```python
def add_middleware(middleware: logicpwn.core.middleware.middleware.BaseMiddleware)
```

Add middleware to the global manager.

### disable_middleware

:::note[Function]
Module function
:::

```python
def disable_middleware(name: str)
```

Disable middleware in the global manager.

### enable_middleware

:::note[Function]
Module function
:::

```python
def enable_middleware(name: str)
```

Enable middleware in the global manager.

### get_middleware

:::note[Function]
Module function
:::

```python
def get_middleware(name: str) -> Optional[logicpwn.core.middleware.middleware.BaseMiddleware]
```

Get middleware from the global manager.

### list_middleware

:::note[Function]
Module function
:::

```python
def list_middleware() -> list[dict[str, typing.Any]]
```

List all middleware in the global manager.

### remove_middleware

:::note[Function]
Module function
:::

```python
def remove_middleware(name: str)
```

Remove middleware from the global manager.


## Related Modules

:::tip[Middleware Modules]
Explore other modules in the Middleware category:

- **[Middleware](../middleware)** - Core middleware functionality
- **[Middleware › Circuit Breaker](../middleware/circuit-breaker)** - Middleware circuit breaker
:::
