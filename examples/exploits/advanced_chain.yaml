exploit_chain:
  name: "Advanced Admin Escalation"
  description: "Demonstrates random/fuzz/context-aware payloads and advanced validation."
  steps:
    - name: "Login as User"
      description: "Authenticate and extract token."
      request_config:
        method: "POST"
        url: "https://api.example.com/login"
        json_data:
          username: "testuser"
          password: "testpass"
      success_indicators:
        - "status_code == 200"
        - "token in response.json"
      data_extractors:
        token: "json:token"
    - name: "Enumerate Users"
      description: "Get user list with token."
      request_config:
        method: "GET"
        url: "https://api.example.com/api/users"
        headers:
          Authorization: "Bearer {{token}}"
      success_indicators:
        - "status_code == 200"
        - "users in response.json"
      data_extractors:
        first_user_id: "json:users.0.id"
    - name: "Fuzz User Role"
      description: "Try to escalate role with fuzz/random payload."
      request_config:
        method: "PUT"
        url: "https://api.example.com/api/users/{{first_user_id}}/role"
        headers:
          Authorization: "Bearer {{token}}"
      payload_injection_points:
        - location: "json_path"
          target_field: "role"
          payload_type: "fuzz"
          payload_value: ""
      success_indicators:
        - "status_code == 200"
        - "py:'admin' in response.text"
        - "jsonpath:$.role"
      failure_indicators:
        - "forbidden"
        - "unauthorized"
      data_extractors:
        new_role: "json:role"
    - name: "Verify Escalation"
      description: "Check if escalation worked."
      request_config:
        method: "GET"
        url: "https://api.example.com/api/admin/panel"
        headers:
          Authorization: "Bearer {{token}}"
      success_indicators:
        - "status_code == 200"
        - "session:new_role == 'admin'"
        - "py:'admin_dashboard' in response.text"
      failure_indicators:
        - "status_code == 403"
        - "unauthorized" 